
include ./Makefile.constants

COMMON_DOCKER_VARS = "EMAIL=${TEST_EMAIL}"\
    "STACK_NAME=${STACK_NAME}"\
    "BOCRA_PGADMIN_ADDRESS=${BOCRA_PGADMIN_ADDRESS}"\
    "BOCRA_DB_ADDRESS=${BOCRA_DB_ADDRESS}"\
    "KEYCLOAK_PUBLIC_PORT=${KEYCLOAK_PUBLIC_PORT}"\
    "BOCRA_API_ADDRESS=${BOCRA_API_ADDRESS}"\
    "BOCRA_PROXY_ADDRESS=${BOCRA_PROXY_ADDRESS}"\
    "ACME_STORAGE=${ACME_STORAGE}"\
    "TRAEFIK_PUBLIC_NETWORK=${TRAEFIK_PUBLIC_NETWORK}"\
    "TRAEFIK_TAG=${TRAEFIK_TAG}"\
    "TRAEFIK_PUBLIC_TAG=${TRAEFIK_PUBLIC_TAG}"\
    "TRAEFIK_USER=${TRAEFIK_USER}"\
    "TRAEFIK_PASSWORD=${TRAEFIK_PASSWORD}"\
    "BOCRA_WEB_ADDRESS=${BOCRA_WEB_ADDRESS}"\
    "POSTGRES_SERVER=${BOCRA_DB_ADDRESS}"\
    "POSTGRES_SERVER_PORT=${POSTGRES_SERVER_PORT}"\
    "POSTGRES_USER=${POSTGRES_USER}"\
    "POSTGRES_PASSWORD=${POSTGRES_PASSWORD}"\
    "POSTGRES_DB=${POSTGRES_DB}"\
    "PGADMIN_LISTEN_PORT=${PGADMIN_LISTEN_PORT}"\
    "PGADMIN_DEFAULT_EMAIL=${PGADMIN_DEFAULT_EMAIL}"\
    "PGADMIN_DEFAULT_PASSWORD=${PGADMIN_DEFAULT_PASSWORD}"\
    "KEYCLOAK_DB=${KEYCLOAK_DB}"\
    "KEYCLOAK_USER=${KEYCLOAK_USER}"\
    "KEYCLOAK_PASSWORD=${KEYCLOAK_PASSWORD}"\
    "KEYCLOAK_REALM=${KEYCLOAK_REALM}"\
    "KEYCLOAK_SERVER_PORT=${KEYCLOAK_SERVER_PORT}"\
    "WEB_DEV_SERVER_PORT=${WEB_DEV_SERVER_PORT}"\
    "API_SERVER_PORT=${API_SERVER_PORT}"\
    "API_UPLOADS=${API_UPLOADS}"\
    "KEYCLOAK_MAIN_CLIENT=${KEYCLOAK_MAIN_CLIENT}"\
    "KEYCLOAK_WEB_CLIENT_ID=${KEYCLOAK_WEB_CLIENT_ID}"\
    "KEYCLOAK_API_CLIENT=${KEYCLOAK_API_CLIENT}"\
    "KEYCLOAK_WEB_CLIENT=${KEYCLOAK_WEB_CLIENT}"\
    "BOCRA_REGISTRY_ADDRESS=${BOCRA_REGISTRY_ADDRESS}"\
    "REGISTRY_HTTP_TLS_CERTIFICATE=${REGISTRY_HTTP_TLS_CERTIFICATE}"\
    "REGISTRY_HTTP_TLS_KEY=${REGISTRY_HTTP_TLS_KEY}"\
    "REGISTRY_AUTH=${REGISTRY_AUTH}"\
    "REGISTRY_AUTH_HTPASSWD_PATH=${REGISTRY_AUTH_HTPASSWD_PATH}"\
    "REGISTRY_AUTH_HTPASSWD_REALM=${REGISTRY_AUTH_HTPASSWD_REALM}"\
    "BOCRA_JENKINS_ADDRESS=${BOCRA_JENKINS_ADDRESS}"\
    "BOCRA_JENKINS_SUBDOMAIN=${BOCRA_JENKINS_SUBDOMAIN}"\
    "BOCRA_REGISTRY_SUBDOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}"\

COMMON_LOCAL_VARS = "export EMAIL=${TEST_EMAIL}"\
    "export STACK_NAME=${STACK_NAME}"\
    "export BOCRA_PGADMIN_ADDRESS=${BOCRA_PGADMIN_ADDRESS}"\
    "export BOCRA_DB_ADDRESS=${BOCRA_DB_ADDRESS}"\
    "export BOCRA_API_ADDRESS=${BOCRA_API_ADDRESS}"\
    "export ACME_STORAGE=${ACME_STORAGE}"\
    "export TRAEFIK_PUBLIC_NETWORK=${TRAEFIK_PUBLIC_NETWORK}"\
    "export TRAEFIK_TAG=${TRAEFIK_TAG}"\
    "export TRAEFIK_PUBLIC_TAG=${TRAEFIK_PUBLIC_TAG}"\
    "export TRAEFIK_USER=${TRAEFIK_USER}"\
    "export TRAEFIK_PASSWORD=${TRAEFIK_PASSWORD}"\
    "export BOCRA_WEB_ADDRESS=${BOCRA_WEB_ADDRESS}"\
    "export POSTGRES_SERVER=${BOCRA_DB_ADDRESS}"\
    "export POSTGRES_SERVER_PORT=${POSTGRES_SERVER_PORT}"\
    "export POSTGRES_USER=${POSTGRES_USER}"\
    "export POSTGRES_PASSWORD=${POSTGRES_PASSWORD}"\
    "export POSTGRES_DB=${POSTGRES_DB}"\
    "export PGADMIN_LISTEN_PORT=${PGADMIN_LISTEN_PORT}"\
    "export PGADMIN_DEFAULT_EMAIL=${PGADMIN_DEFAULT_EMAIL}"\
    "export PGADMIN_DEFAULT_PASSWORD=${PGADMIN_DEFAULT_PASSWORD}"\
    "export KEYCLOAK_WEB_CLIENT_ID=${KEYCLOAK_WEB_CLIENT_ID}"\
    "export KEYCLOAK_DB=${KEYCLOAK_DB}"\
    "export KEYCLOAK_USER=${KEYCLOAK_USER}"\
    "export KEYCLOAK_PASSWORD=${KEYCLOAK_PASSWORD}"\
    "export KEYCLOAK_REALM=${KEYCLOAK_REALM}"\
    "export KEYCLOAK_SERVER_PORT=${KEYCLOAK_SERVER_PORT}"\
    "export KEYCLOAK_PUBLIC_PORT=${KEYCLOAK_PUBLIC_PORT}"\
    "export WEB_DEV_SERVER_PORT=${WEB_DEV_SERVER_PORT}"\
    "export API_SERVER_PORT=${API_SERVER_PORT}"\
    "export API_SERVER=${API_SERVER}"\
    "export KEYCLOAK_MAIN_CLIENT=${KEYCLOAK_MAIN_CLIENT}"\
    "export KEYCLOAK_API_CLIENT=${KEYCLOAK_API_CLIENT}"\
    "export KEYCLOAK_WEB_CLIENT=${KEYCLOAK_WEB_CLIENT}"\
    "export BOCRA_REGISTRY_ADDRESS=${BOCRA_REGISTRY_ADDRESS}"\
    "export REGISTRY_HTTP_TLS_CERTIFICATE=${REGISTRY_HTTP_TLS_CERTIFICATE}"\
    "export REGISTRY_HTTP_TLS_KEY=${REGISTRY_HTTP_TLS_KEY}"\
    "export REGISTRY_AUTH=${REGISTRY_AUTH}"\
    "export REGISTRY_AUTH_HTPASSWD_PATH=${REGISTRY_AUTH_HTPASSWD_PATH}"\
    "export REGISTRY_AUTH_HTPASSWD_REALM=${REGISTRY_AUTH_HTPASSWD_REALM}"\
    "export BOCRA_JENKINS_ADDRESS=${BOCRA_JENKINS_ADDRESS}"\
    "export BOCRA_JENKINS_SUBDOMAIN=${BOCRA_JENKINS_SUBDOMAIN}"\
    "export BOCRA_REGISTRY_SUBDOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}"\

LOCAL_DOCKER_ENV = printf "%s\n" \
    "IMAGE_VERSION=${DEV_IMAGE_VERSION}"\
    "DOMAIN=${LOCAL_DOMAIN}"\
    "BOCRA_DATA=~/${BOCRA_DATA}"\
    "DB_DOMAIN=${BOCRA_DB_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "PGADMIN_DOMAIN=${BOCRA_PGADMIN_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "PROXY_DOMAIN=${BOCRA_PROXY_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "API_DOMAIN=${BOCRA_API_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "WEB_DOMAIN=${BOCRA_WEB_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "REGISTRY_DOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "JENKINS_DOMAIN=${BOCRA_JENKINS_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "KEYCLOAK_DOMAIN=${BOCRA_KEYCLOAK_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "REDIRECT_URI=${LOCAL_REDIRECT_URI}"\
    "SMTP_HOST=${LOCAL_SMTP_HOST}"\
    "BOCRA_KEYCLOAK_ADDRESS=${BOCRA_KEYCLOAK_LOCAL_ADDRESS}"\
    "BOCRA_KEYCLOAK_DOMAIN=${BOCRA_KEYCLOAK_LOCAL_DOMAIN}"\
    "KEYCLOAK_AUTH_URL=${KEYCLOAK_LOCAL_BASE_URL}"\
    "API_URL=${API_SERVER}:${API_SERVER_PORT}/"\
    "ACME_EMAIL=${LOCAL_ACME_EMAIL}"\
    "WEB_SUBDOMAIN=${BOCRA_WEB_SUBDOMAIN}."\
    ${COMMON_DOCKER_VARS}\
    >> .env

DEV_DOCKER_ENV = printf "%s\n" \
    "IMAGE_VERSION=${TEST_IMAGE_VERSION}"\
    "DOMAIN=${TEST_DOMAIN}"\
    "BOCRA_DATA=${BOCRA_DATA}"\
    "REDIRECT_URI=${TEST_REDIRECT_URI}"\
    "SMTP_HOST=${TEST_SMTP_HOST}"\
    "BOCRA_KEYCLOAK_ADDRESS=${BOCRA_KEYCLOAK_TEST_ADDRESS}"\
    "REGISTRY_DOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}.${TEST_DOMAIN}"\
    "JENKINS_DOMAIN=${BOCRA_JENKINS_SUBDOMAIN}.${TEST_DOMAIN}"\
    "KEYCLOAK_AUTH_URL=http://${DEV_SERVER_ADDRESS}:${KEYCLOAK_PUBLIC_PORT}"\
    "KEYCLOAK_API_SECRET=${KEYCLOAK_TEST_API_SECRET}"\
    "ACME_EMAIL=${TEST_ACME_EMAIL}"\
    "API_URL=http://${DEV_SERVER_ADDRESS}:${API_SERVER_PORT}/"\
    "WEB_URL=http://${DEV_SERVER_ADDRESS}:${WEB_DEV_SERVER_PORT}"\
    "WEB_SUBDOMAIN=bocra."\
    "WEB_DEV_SERVER_PORT=${WEB_DEV_SERVER_PORT}"\
    "WEB_PUBLIC_PORT=${WEB_DEV_SERVER_PORT}"\
    "DEV_SERVER_ADDRESS=${DEV_SERVER_ADDRESS}"\
    ${COMMON_DOCKER_VARS}\
    >> .env

TEST_DOCKER_ENV = printf "%s\n" \
    "IMAGE_VERSION=${TEST_IMAGE_VERSION}"\
    "DOMAIN=${TEST_DOMAIN}"\
    "BOCRA_DATA=${BOCRA_DATA}"\
    "REDIRECT_URI=${TEST_REDIRECT_URI}"\
    "SMTP_HOST=${TEST_SMTP_HOST}"\
    "BOCRA_KEYCLOAK_ADDRESS=${BOCRA_KEYCLOAK_TEST_ADDRESS}"\
    "REGISTRY_DOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}.${TEST_DOMAIN}"\
    "JENKINS_DOMAIN=${BOCRA_JENKINS_SUBDOMAIN}.${TEST_DOMAIN}"\
    "KEYCLOAK_AUTH_URL=${KEYCLOAK_TEST_BASE_URL}"\
    "KEYCLOAK_API_SECRET=${KEYCLOAK_TEST_API_SECRET}"\
    "ACME_EMAIL=${TEST_ACME_EMAIL}"\
    "API_URL=${API_SERVER}:${API_SERVER_PORT}/"\
    "WEB_SUBDOMAIN=bocra."\
    ${COMMON_DOCKER_VARS}\
    >> .env

LIVE_DOCKER_ENV = printf "%s\n" \
    "IMAGE_VERSION=${LIVE_IMAGE_VERSION}"\
    "DOMAIN=${LIVE_DOMAIN}"\
    "BOCRA_DATA=${BOCRA_DATA}"\
    "REDIRECT_URI=${LIVE_REDIRECT_URI}"\
    "SMTP_HOST=${LIVE_SMTP_HOST}"\
    "BOCRA_KEYCLOAK_ADDRESS=${BOCRA_KEYCLOAK_LIVE_ADDRESS}"\
    "REGISTRY_DOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "JENKINS_DOMAIN=${BOCRA_JENKINS_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "KEYCLOAK_AUTH_URL=${KEYCLOAK_LIVE_BASE_URL}"\
    "KEYCLOAK_API_SECRET=${KEYCLOAK_LIVE_API_SECRET}"\
    "ACME_EMAIL=${LIVE_ACME_EMAIL}"\
    "API_URL=${API_SERVER}:${API_SERVER_PORT}/"\
    ${COMMON_DOCKER_VARS}\
    >> .env
    
LOCAL_ENV = printf "%s\n" \
	"\#!/bin/sh"\
    "export BOCRA_DATA=${HOME}/${BOCRA_DATA}"\
    "export IMAGE_VERSION=${DEV_IMAGE_VERSION}"\
    "export DOMAIN=${LOCAL_DOMAIN}"\
    "export DB_DOMAIN=${BOCRA_DB_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export PGADMIN_DOMAIN=${BOCRA_PGADMIN_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export PROXY_DOMAIN=${BOCRA_PROXY_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export API_DOMAIN=${BOCRA_API_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export WEB_DOMAIN=${BOCRA_WEB_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export KEYCLOAK_DOMAIN=${BOCRA_KEYCLOAK_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export REGISTRY_DOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export JENKINS_DOMAIN=${BOCRA_JENKINS_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export REDIRECT_URI=${LOCAL_REDIRECT_URI}"\
    "export SMTP_HOST=${LOCAL_SMTP_HOST}"\
    "export BOCRA_KEYCLOAK_ADDRESS=${BOCRA_KEYCLOAK_LOCAL_ADDRESS}"\
    "export KEYCLOAK_AUTH_URL=${KEYCLOAK_LOCAL_BASE_URL}"\
    "export KEYCLOAK_API_SECRET=${KEYCLOAK_LOCAL_API_SECRET}"\
    "export ACME_EMAIL=${LOCAL_ACME_EMAIL}"\
    "export WEB_URL=${BOCRA_WEB_SUBDOMAIN}.${LOCAL_DOMAIN}"\
    "export API_URL=${LOCAL_API_URL}/"\
    ${COMMON_LOCAL_VARS}\
    >> .env

DEV_ENV = printf "%s\n" \
	"\#!/bin/sh"\
    "export BOCRA_DATA=${BOCRA_DATA}"\
    "export IMAGE_VERSION=${DEV_IMAGE_VERSION}"\
    "export DOMAIN=${DEV_DOMAIN}"\
    "export DB_DOMAIN=${BOCRA_DB_SUBDOMAIN}.${DEV_DOMAIN}"\
    "export PGADMIN_DOMAIN=${BOCRA_PGADMIN_SUBDOMAIN}.${DEV_DOMAIN}"\
    "export PROXY_DOMAIN=${BOCRA_PROXY_SUBDOMAIN}.${DEV_DOMAIN}"\
    "export API_DOMAIN=${BOCRA_API_SUBDOMAIN}.${DEV_DOMAIN}"\
    "export WEB_DOMAIN=${BOCRA_WEB_SUBDOMAIN}.${DEV_DOMAIN}"\
    "export KEYCLOAK_DOMAIN=${BOCRA_KEYCLOAK_SUBDOMAIN}.${DEV_DOMAIN}"\
    "export REGISTRY_DOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}.${DEV_DOMAIN}"\
    "export JENKINS_DOMAIN=${BOCRA_JENKINS_SUBDOMAIN}.${DEV_DOMAIN}"\
    "export REDIRECT_URI=${DEV_REDIRECT_URI}"\
    "export SMTP_HOST=${DEV_SMTP_HOST}"\
    "export BOCRA_KEYCLOAK_ADDRESS=${BOCRA_KEYCLOAK_ADDRESS}"\
    "export KEYCLOAK_AUTH_URL=http://${DEV_SERVER_ADDRESS}:${KEYCLOAK_PUBLIC_PORT}"\
    "export KEYCLOAK_API_SECRET=${KEYCLOAK_DEV_API_SECRET}"\
    "export ACME_EMAIL=${DEV_ACME_EMAIL}"\
    "export WEB_DEV_SERVER_PORT=${WEB_DEV_SERVER_PORT}"\
    "export WEB_URL=${DEV_SERVER_ADDRESS}:${WEB_DEV_SERVER_PORT}"\
    "export WEB_PUBLIC_PORT=${WEB_DEV_SERVER_PORT}"\
    "export DEV_SERVER_ADDRESS=${DEV_SERVER_ADDRESS}"\
    "export API_URL=http://${DEV_SERVER_ADDRESS}:${API_SERVER_PORT}/"\
    ${COMMON_LOCAL_VARS}\
    >> .env

TEST_ENV = printf "%s\n" \
	"\#!/bin/sh"\
    "export BOCRA_DATA=${BOCRA_DATA}"\
    "export IMAGE_VERSION=${DEV_IMAGE_VERSION}"\
    "export DOMAIN=${TEST_DOMAIN}"\
    "export DB_DOMAIN=${BOCRA_DB_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export PGADMIN_DOMAIN=${BOCRA_PGADMIN_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export PROXY_DOMAIN=${BOCRA_PROXY_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export API_DOMAIN=${BOCRA_API_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export WEB_DOMAIN=${BOCRA_WEB_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export KEYCLOAK_DOMAIN=${BOCRA_KEYCLOAK_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export REGISTRY_DOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export JENKINS_DOMAIN=${BOCRA_JENKINS_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export REDIRECT_URI=${TEST_REDIRECT_URI}"\
    "export SMTP_HOST=${TEST_SMTP_HOST}"\
    "export BOCRA_KEYCLOAK_ADDRESS=${BOCRA_KEYCLOAK_TEST_ADDRESS}"\
    "export KEYCLOAK_AUTH_URL=${KEYCLOAK_TEST_BASE_URL}"\
    "export KEYCLOAK_API_SECRET=${KEYCLOAK_TEST_API_SECRET}"\
    "export ACME_EMAIL=${TEST_ACME_EMAIL}"\
    "export WEB_URL=${BOCRA_WEB_SUBDOMAIN}.${TEST_DOMAIN}"\
    "export API_URL=${API_SERVER}:${API_SERVER_PORT}/"\
    ${COMMON_LOCAL_VARS}\
    >> .env

LIVE_ENV = printf "%s\n" \
	"\#!/bin/sh"\
    "export BOCRA_DATA=${BOCRA_DATA}"\
    "export IMAGE_VERSION=${DEV_IMAGE_VERSION}"\
    "export DOMAIN=${LIVE_DOMAIN}"\
    "export DB_DOMAIN=${BOCRA_DB_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export PGADMIN_DOMAIN=${BOCRA_PGADMIN_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export PROXY_DOMAIN=${BOCRA_PROXY_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export API_DOMAIN=${BOCRA_API_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export WEB_DOMAIN=${BOCRA_WEB_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export KEYCLOAK_DOMAIN=${BOCRA_KEYCLOAK_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export REGISTRY_DOMAIN=${BOCRA_REGISTRY_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export JENKINS_DOMAIN=${BOCRA_JENKINS_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export REDIRECT_URI=${LIVE_REDIRECT_URI}"\
    "export SMTP_HOST=${LIVE_SMTP_HOST}"\
    "export BOCRA_KEYCLOAK_ADDRESS=${BOCRA_KEYCLOAK_LIVE_ADDRESS}"\
    "export KEYCLOAK_AUTH_URL=${KEYCLOAK_LIVE_BASE_URL}"\
    "export KEYCLOAK_API_SECRET=${KEYCLOAK_LIVE_API_SECRET}"\
    "export ACME_EMAIL=${LIVE_ACME_EMAIL}"\
    "export WEB_URL=${BOCRA_WEB_SUBDOMAIN}.${LIVE_DOMAIN}"\
    "export API_URL=${API_SERVER}:${API_SERVER_PORT}/"\
    ${COMMON_LOCAL_VARS}\
    >> .env