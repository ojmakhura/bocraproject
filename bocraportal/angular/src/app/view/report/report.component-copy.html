<div class="card container">
	<div class="card-body">
		<form [formGroup]="reportForm">
			<div formArrayName="formReports" class="container">
				<div class="card-body" *ngFor="let formReport of formReports; let i=index"
					[formGroupName]="i">
					<div class="row mb-3">
						<h4>Form Name: {{formReport?.formName}}</h4>
					</div>
					<div class="row mb-3">
						<label id="submission_num-{{i}}-label" class="col-sm-2 col-form-label">Number of Submissions:
						</label>
						<label id="submission_num-{{i}}-label"
							class="col-sm-2 col-form-label">{{formReport?.submissions?.length}}</label>
					</div>
					<div class="row mb-3">
					</div>

					<div formArrayName="reportElements">
						<div *ngFor="let elementControl of getReportElementsControl(i)?.controls; let j=index;"
							[formGroupName]="j">
							<div class="mb-3">
								<div class="mb-3">
									<label for="chart-type-{{i}}-{{j}}">Chart Type</label>
									<select id="chart-type-{{i}}-{{j}}" class="form-select" formControlName="chartType"
										aria-label="Default select example" (change)="selectedChartType($event, i, j, formReport?.reportElements[j])">
										<option value="bar">Bar</option>
										<!-- <option value="bubble">Bubble</option> -->
										<!-- <option value="doughnut">Doughnut</option> -->
										<!-- <option value="line">Line</option> -->
										<option value="pie">Pie</option>
										<!-- <option value="polarArea">Polar Area</option> -->
										<!-- <option value="radar">Radar</option> -->
										<!-- <option value="scatter">Scatter</option> -->
									</select>
								</div>
								<div >
									<div *ngFor="let sectionGraph of formReport?.reportElements[j].sectionGraphs let k=index">
										<div class="mb-3">
											<h5 >Section: {{sectionGraph.section}}</h5>
										</div>
										<div *ngIf="isBarChart(formReport?.reportElements[j].chartType) | async">
											<canvas #chart baseChart 
												[datasets]="sectionGraph.licenseeGraphData"
												[labels]="sectionGraph.fieldList"
												[type]="formReport?.reportElements[j].chartType">
											</canvas>
										</div>
										<div *ngIf="formReport?.reportElements[j].chartType === 'pie'">
											<div *ngFor="let graph of sectionGraph.fieldGraphs; let l=index">
												<h6>{{sectionGraph.fieldList[l]}}</h6>
												<canvas #chart baseChart 
													[datasets]="[{data: graph}]"
													[labels]="formReport.licensees"
													[type]="formReport?.reportElements[j].chartType">
												</canvas>
											</div>
										</div>
										<br>
									</div>
								</div>
								<button type="button" class="btn btn-primary" (click)="removeReportElement(i, j)">
									<mat-icon>delete</mat-icon>
								</button>
							</div>
						</div>
						<div>
							<button type="button" class="btn bi bi-plus-circle" (click)="addReportElement(i)"></button>
						</div>
					</div>
				</div>
			</div>
		</form>
	</div>
</div>